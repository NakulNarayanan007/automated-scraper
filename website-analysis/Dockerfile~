############################################################
# Dockerfile for a Scrapy development environment
# Based on Python:2.7 Image
############################################################

FROM python:2.7
MAINTAINER jithin.sayone@gmail.com

RUN apt-get update
RUN apt-get --assume-yes install xvfb 
RUN apt-get --assume-yes install wkhtmltopdf
ENV DISPLAY=:1.0
#RUN Xvfb :1 -screen 0 1024x768x16 &> xvfb.log  &
 
#RUN apt-get  --assume-yes install qt4-qmake libqt4-dev


#install requirement packages
RUN pip install attrs==15.2.0
RUN pip install cffi==1.6.0
RUN pip install cryptography==1.3.2
RUN pip install cssselect==0.9.1
RUN pip install lxml==3.6.0
RUN pip install parsel==1.0.2
RUN pip install pyasn1-modules==0.0.8
RUN pip install PyDispatcher==2.0.5
RUN pip install pyOpenSSL==16.0.0
RUN pip install PyYAML==3.11
RUN pip install queuelib==1.4.2
RUN pip install requests==2.10.0
RUN pip install Scrapy==1.2.0
RUN pip install selenium==2.53.2
RUN pip install Twisted==16.2.0
RUN pip install zope.interface==4.1.3
RUN pip install translate
RUN pip install psycopg2==2.6.2
RUN pip install scrapinghub==1.9.0
RUN pip install bs4==0.0.1
RUN pip install geopy==1.11.0
RUN pip install requests-cache==0.4.12
RUN pip install feedparser==5.2.1
RUN pip install pybloom==1.1
RUN pip install boto==2.43.0
RUN pip install matplotlib==1.5.3

#Install Phandomjs
RUN wget -q https://bitbucket.org/ariya/phantomjs/downloads/phantomjs-2.1.1-linux-x86_64.tar.bz2 && \
    tar -xjf phantomjs-2.1.1-linux-x86_64.tar.bz2 && \
    mv phantomjs-2.1.1-linux-x86_64/bin/phantomjs /usr/bin && \
    rm -rf phantomjs-2.1.1-linux-x86_64.tar.bz2 phantomjs-2.1.1-linux-x86_64

#Add folder to docker
ADD . /home/sme-scraper-website

COPY start_crawl.py /cmd/start_crawl.py




ENTRYPOINT  python /cmd/start_crawl.py

